# CHANGELOG v1.11.0 — 增强沟通机制

**发布日期**: 2026-02-11

---

## 🎯 核心改进：从"基础沟通"到"充分沟通"

v1.11.0 对 P1 需求和设计阶段进行了**重大增强**，从 2 个确认点扩展到 **5 个关键决策点**，确保在编码前与用户充分沟通，避免基于假设开发。

---

## ✨ 主要更新

### 1. 智能补充机制（新增）

**问题**：用户提出的需求往往过于简单（如"做一个登录功能"），缺少配套功能和边界场景的考虑。

**解决方案**：从功能性角度主动补充需求

**补充维度**：
- **核心功能**：用户明确提出的功能
- **扩展功能**：围绕核心功能的常见配套功能
  - 示例：登录 → 补充询问：忘记密码？记住我？多设备登录？
  - 示例：数据展示 → 补充询问：分页？搜索？筛选？排序？导出？
- **相关功能**：提升用户体验的功能
  - 加载状态、错误提示、操作成功反馈
  - 空状态处理、权限控制、操作确认

**影响文件**：
- `CLAUDE.md` - P1 步骤 1
- `.claude/rules/01-lifecycle-phases.md` - 需求澄清环节
- `README.md` - 工作流程说明

---

### 2. 充分询问标准（新增）

**问题**：何时停止询问、进入下一阶段缺乏明确标准，导致沟通不充分或过度询问。

**解决方案**：定义 6 个判断标准，Claude 自行判断是否充分

**判断标准**（满足所有条件才推进）：
- ✅ 核心功能清晰（知道必须做什么）
- ✅ 扩展功能明确（知道建议做什么、用户要不要）
- ✅ 相关功能确定（知道哪些体验功能要包含）
- ✅ 优先级清楚（知道先做什么后做什么）
- ✅ 关键约束已知（技术栈偏好、性能、兼容性）
- ✅ UI 方向确定（如涉及界面：知道期望的风格和参考）

**不限定询问轮数**：根据需求复杂度灵活调整，简单需求 3-5 轮，复杂需求 8+ 轮。

**影响文件**：
- `.claude/rules/01-lifecycle-phases.md` - 判断充分性部分

---

### 3. 技术栈偏好询问（新增）

**问题**：直接调研技术方案可能与用户现有技术栈或团队技能不匹配。

**解决方案**：技术调研前先询问用户偏好和约束

**询问内容**：
- 现有技术栈是什么？（如果是现有项目）
- 团队技能栈偏好？（擅长什么技术？）
- 项目约束？（部署环境、预算、时间）
- 性能要求？（并发量、响应时间）
- 兼容性要求？（浏览器、设备、操作系统）

**执行流程**：
1. 询问偏好和约束
2. 基于偏好进行针对性调研
3. 展示调研结果并确认技术栈

**影响文件**：
- `CLAUDE.md` - P1 步骤 2
- `.claude/rules/01-lifecycle-phases.md` - 技术调研环节

---

### 4. 架构方案对比（重大变更）

**问题**：只提供单一架构方案，用户无法了解其他可能性，缺乏选择权。

**解决方案**：提供 2-3 个可选架构方案，说明优缺点和适用场景

**每个方案包含**：
- **方案名称**：如"单体应用"、"模块化架构"、"微服务架构"
- **模块划分**：系统分为哪几个模块？模块间如何交互？
- **数据模型**：核心实体和关系
- **接口定义**：主要 API 设计
- **技术选型细化**：具体版本、配置、依赖关系
- **部署架构**：开发/测试/生产环境
- **优点**：这个方案的优势是什么？
- **缺点**：这个方案的劣势或风险是什么？
- **适用场景**：什么情况下推荐这个方案？

**推荐标注**（可选）：如果有明显最优方案，可标注"推荐"并说明理由。

**影响文件**：
- `CLAUDE.md` - P1 步骤 4
- `.claude/rules/01-lifecycle-phases.md` - 架构设计环节

---

### 5. 五个关键决策点（扩展）

**变更**：从 2 个确认点扩展到 5 个关键决策点

| 决策点 | 位置 | 确认内容 | 新增/原有 |
|--------|------|---------|----------|
| **决策点1** | P1.1 需求澄清后 | 需求理解正确，补充的功能是否需要 | ✨ 新增 |
| **决策点2** | P1.2 技术调研后 | 技术栈选型确认 | ✨ 新增 |
| **决策点3** | P1.3 PRD 编写后 | PRD 内容确认 | ✅ 原有 |
| **决策点4** | P1.4 架构设计后 | 架构方案选择确认 | ✨ 新增 |
| **决策点5** | P1.5 原型设计后 | 设计风格和交互确认 | ✅ 原有 |

**推进条件**：所有 5 个决策点确认后才推进到 P2 自动驱动。

**影响文件**：
- `README.md` - 工作流程图
- `CLAUDE.md` - P1 阶段各步骤
- `.claude/rules/01-lifecycle-phases.md` - 各决策点定义

---

## 📝 文件变更清单

| 文件 | 变更类型 | 主要内容 |
|------|---------|---------|
| `README.md` | 更新 | 工作流程增加 5 个决策点，增加核心特色说明 |
| `template/CLAUDE.md` | 更新 | P1 阶段增加智能补充、技术偏好询问、方案对比 |
| `template/.claude/rules/01-lifecycle-phases.md` | 重大更新 | P1 各步骤详细定义，增加判断标准和方案对比流程 |
| `package.json` | 更新 | 版本号 1.10.0 → 1.11.0 |

---

## 🎯 对用户的影响

### 优点

1. **需求更完整**：通过智能补充，避免遗漏常见配套功能和边界场景
2. **选择更透明**：了解技术偏好后调研，架构设计提供多方案对比
3. **沟通更充分**：5 个决策点确保每个关键环节都经过确认
4. **风险更低**：编码前充分沟通，减少后期返工

### 需要注意

1. **P1 阶段时间增加**：从 2 个确认点增加到 5 个，需要更多沟通时间
2. **用户参与度提高**：需要在 5 个决策点主动确认，不能完全依赖自动驱动

**适合场景**：
- ✅ 中大型项目：充分沟通避免后期大量返工
- ✅ 需求不明确：通过智能补充和多轮对话明确需求
- ✅ 技术选型重要：团队技能栈有限或有特定约束

**不适合场景**：
- ❌ 紧急小修复：5 个决策点可能过于繁琐
- ❌ 需求极其明确：智能补充和多轮询问可能显得冗余

---

## 🔄 升级指南

### 自动升级（推荐）

```bash
cd your-project
npx claude-sdlc
```

安装器自动检测并升级到 v1.11.0，保留用户自定义配置。

### 手动检查

升级后检查以下文件是否更新：
- `CLAUDE.md` - P1 阶段描述
- `.claude/rules/01-lifecycle-phases.md` - 需求澄清、技术调研、架构设计环节
- `README.md` - 工作流程图

---

## 📊 版本对比

| 维度 | v1.10.0 | v1.11.0 |
|------|---------|---------|
| 确认点数量 | 2 | **5** |
| 需求补充 | 无 | **智能补充（功能性）** |
| 询问标准 | 无 | **6 个判断标准** |
| 技术偏好 | 直接调研 | **先询问偏好** |
| 架构方案 | 单一方案 | **2-3 个方案对比** |
| 沟通程度 | 基础 | **充分** |

---

## 🚀 下一步计划

v1.12.0 可能包含：
- P4 审查阶段的智能分级（critical/major/minor）
- 支持自定义决策点配置
- 增加"快速模式"（跳过部分决策点用于小修复）

---

## 💡 反馈

如遇问题或有改进建议，请访问：
https://github.com/Muqian-Sun/claude-sdlc/issues

---

**感谢使用 claude-sdlc！**
